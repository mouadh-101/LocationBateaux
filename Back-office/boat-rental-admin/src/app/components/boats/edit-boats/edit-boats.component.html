<div class="mb-4">
  <button
    routerLink="/list"
    class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-md transition"
  >
    ← Annuler la Modification
  </button>
</div>

<h2 class="form-title">Modifier un bateau</h2>

<div class="card-form">
  <form #form="ngForm" (ngSubmit)="updateBoat()" class="form-card" novalidate>

    <!-- Nom -->
    <label for="nom">Nom du bateau</label>
    <input
      type="text"
      id="nom"
      [(ngModel)]="boat.nom"
      name="nom"
      #nom="ngModel"
      required
      minlength="3"
      maxlength="50"
    />
    <div *ngIf="nom.invalid && nom.touched" class="error-msg">
      <small *ngIf="nom.errors?.['required']">Le nom est obligatoire.</small>
      <small *ngIf="nom.errors?.['minlength']">Minimum 3 caractères.</small>
      <small *ngIf="nom.errors?.['maxlength']">Maximum 50 caractères.</small>
    </div>

    <!-- Description -->
    <label for="description">Description</label>
    <textarea
      id="description"
      [(ngModel)]="boat.description"
      name="description"
      #description="ngModel"
      required
      minlength="10"
      maxlength="300"
    ></textarea>
    <div *ngIf="description.invalid && description.touched" class="error-msg">
      <small *ngIf="description.errors?.['required']">La description est obligatoire.</small>
      <small *ngIf="description.errors?.['minlength']">Minimum 10 caractères.</small>
      <small *ngIf="description.errors?.['maxlength']">Maximum 300 caractères.</small>
    </div>

    <!-- Prix -->
    <label for="prix">Prix TND</label>
    <input
      type="number"
      id="prix"
      [(ngModel)]="boat.prix"
      name="prix"
      #prix="ngModel"
      min="0"
      required
    />
    <div *ngIf="prix.invalid && prix.touched" class="error-msg">
      <small *ngIf="prix.errors?.['required']">Le prix est obligatoire.</small>
      <small *ngIf="prix.errors?.['min']">Le prix doit être supérieur ou égal à 0.</small>
    </div>

    <!-- Port -->
    <label for="port">Port</label>
    <input
      type="text"
      id="port"
      [(ngModel)]="boat.port.nom"
      name="port"
      #port="ngModel"
      required
      minlength="2"
      maxlength="50"
    />
    <div *ngIf="port.invalid && port.touched" class="error-msg">
      <small *ngIf="port.errors?.['required']">Le port est obligatoire.</small>
      <small *ngIf="port.errors?.['minlength']">Minimum 2 caractères.</small>
      <small *ngIf="port.errors?.['maxlength']">Maximum 50 caractères.</small>
    </div>
    <br><br>

    <!-- Caractéristiques -->
    <fieldset class="caracteristique-section">
      <label>Caractéristiques :</label>

      <label for="capacite">Capacité</label>
      <input
        type="number"
        id="capacite"
        [(ngModel)]="boat.carecteristique.capacite"
        name="caracteristique.capacite"
        #capacite="ngModel"
        min="1"
        required
      />
      <div *ngIf="capacite.invalid && capacite.touched" class="error-msg">
        <small *ngIf="capacite.errors?.['required']">La capacité est obligatoire.</small>
        <small *ngIf="capacite.errors?.['min']">Doit être au moins 1.</small>
      </div>

      <label for="longueur">Longueur (m)</label>
      <input
        type="number"
        step="0.1"
        id="longueur"
        [(ngModel)]="boat.carecteristique.longueur"
        name="caracteristique.longueur"
        #longueur="ngModel"
        min="0.1"
        required
      />
      <div *ngIf="longueur.invalid && longueur.touched" class="error-msg">
        <small *ngIf="longueur.errors?.['required']">La longueur est obligatoire.</small>
        <small *ngIf="longueur.errors?.['min']">Doit être positive.</small>
      </div>

      <label for="largeur">Largeur (m)</label>
      <input
        type="number"
        step="0.1"
        id="largeur"
        [(ngModel)]="boat.carecteristique.largeur"
        name="caracteristique.largeur"
        #largeur="ngModel"
        min="0.1"
        required
      />
      <div *ngIf="largeur.invalid && largeur.touched" class="error-msg">
        <small *ngIf="largeur.errors?.['required']">La largeur est obligatoire.</small>
        <small *ngIf="largeur.errors?.['min']">Doit être positive.</small>
      </div>

      <label for="nombreMoteurs">Nombre de moteurs</label>
      <input
        type="number"
        id="nombreMoteurs"
        [(ngModel)]="boat.carecteristique.nombreMoteurs"
        name="caracteristique.nombreMoteurs"
        #nombreMoteurs="ngModel"
        min="0"
        required
      />
      <div *ngIf="nombreMoteurs.invalid && nombreMoteurs.touched" class="error-msg">
        <small *ngIf="nombreMoteurs.errors?.['required']">Le nombre de moteurs est obligatoire.</small>
        <small *ngIf="nombreMoteurs.errors?.['min']">Ne peut pas être négatif.</small>
      </div>

   <label for="type" class="block mb-1 font-semibold text-indigo-700">Type de bateau</label>
<select
  id="type"
  [(ngModel)]="boat.carecteristique.type"
  name="caracteristique.type"
  #type="ngModel"
  required
  class="
    w-full
    px-4 py-2
    rounded-lg
    border-2 border-indigo-400
    bg-gradient-to-r from-indigo-100 to-indigo-50
    text-indigo-900
    shadow-md
    hover:border-indigo-600
    focus:outline-none
    focus:ring-4 focus:ring-indigo-300
    transition
    duration-300
    ease-in-out
    cursor-pointer
  "
>
  <option value="" disabled>-- Choisir un type --</option>
  <option value="YACHT">Yacht</option>
  <option value="VOILIER">Voilier</option>
  <option value="CATAMARAN">Catamaran</option>
  <option value="SPORT">Sport</option>
  <option value="AUTRE">Autre</option>
</select>
<div *ngIf="type.invalid && type.touched" class="text-red-600 text-sm mt-1 font-semibold">
  <small>Le type de bateau est obligatoire.</small>
</div>

    </fieldset>

    <!-- Images -->
    <label for="imageUrl">Ajouter une image (URL)</label>
    <div class="image-input-wrapper">
      <input
        type="text"
        id="imageUrl"
        [(ngModel)]="imageUrl"
        name="imageUrl"
        placeholder="https://..."
        #imageUrlInput="ngModel"
        pattern="https?://.+"
      />
      <button
        type="button"
        class="btn-mini"
        (click)="addImage()"
        [disabled]="!imageUrlInput.valid || !imageUrlInput.dirty"
      >
        Ajouter
      </button>
    </div>
    <div *ngIf="imageUrlInput.invalid && imageUrlInput.touched" class="error-msg">
      <small>L'URL doit commencer par http:// ou https://</small>
    </div>

    <!-- Liste des images -->
    <div *ngIf="boat.images.length > 0" class="images-list">
      <h4>Images actuelles :</h4>
      <ul>
        <li *ngFor="let img of boat.images; let i = index">
          {{ img.url }}
          <button type="button" class="btn-delete" (click)="removeImage(i)">❌</button>
        </li>
      </ul>
    </div>

    <!-- Disponibilité -->
   <div class="flex gap-8 mt-4">
  <!-- Disponible -->
  <label class="relative flex items-center cursor-pointer select-none">
    <input
      type="radio"
      [(ngModel)]="boat.disponible"
      [value]="true"
      name="disponibilite"
      required
      class="peer sr-only"
    />
    <div
      class="w-6 h-6 mr-3 rounded-full border-2 border-gray-400
             peer-checked:border-green-500 peer-checked:bg-green-500
             peer-focus:ring-4 peer-focus:ring-green-300
             transition-all duration-400 ease-in-out
             flex items-center justify-center"
    >
      <div
        class="w-3 h-3 rounded-full bg-white scale-0 peer-checked:scale-100
               transition-transform duration-400 ease-in-out"
      ></div>
    </div>
    <span class="text-gray-900 font-semibold">Disponible</span>
  </label>

  <!-- Indisponible -->
  <label class="relative flex items-center cursor-pointer select-none">
    <input
      type="radio"
      [(ngModel)]="boat.disponible"
      [value]="false"
      name="disponibilite"
      required
      class="peer sr-only"
    />
    <div
      class="w-6 h-6 mr-3 rounded-full border-2 border-gray-400
             peer-checked:border-yellow-500 peer-checked:bg-yellow-500
             peer-focus:ring-4 peer-focus:ring-yellow-300
             transition-all duration-400 ease-in-out
             flex items-center justify-center"
    >
      <div
        class="w-3 h-3 rounded-full bg-white scale-0 peer-checked:scale-100
               transition-transform duration-400 ease-in-out"
      ></div>
    </div>
    <span class="text-gray-900 font-semibold">Indisponible</span>
  </label>
</div>

    <!-- ReservationTypeSettings (checkboxes) -->
    <fieldset class="reservation-settings">
      <label>Types de réservation disponibles</label>

      <label>
        <input
          type="checkbox"
          [(ngModel)]="boat.reservationTypeSettings.full_day_enabled"
          name="fullDay"
        />
        <span>Journée complète</span>
      </label>

      <label>
        <input
          type="checkbox"
          [(ngModel)]="boat.reservationTypeSettings.half_day_enabled"
          name="halfDay"
        />
        <span>Demi-journée</span>
      </label>

      <label>
        <input
          type="checkbox"
          [(ngModel)]="boat.reservationTypeSettings.two_hours_enabled"
          name="twoHours"
        />
        <span>2 heures</span>
      </label>
    </fieldset>

    <!-- Boutons -->
    <div class="form-actions">
  <button
    type="submit"
    class="bg-blue-600 hover:bg-blue-700 disabled:bg-blue-300 text-white font-semibold py-2 px-6 rounded-md shadow-md transition duration-300 ease-in-out"
    [disabled]="form.invalid"
  >
    Mettre à jour
  </button>
</div>

  </form>
</div>
